#ifndef EFTInfo_H
#define EFTInfo_H

// include c++ modules
#include <map>
#include <vector>
#include <algorithm>

// include other parts of framework
#include "../../TreeReader/interface/TreeReader.h"

class EFTInfo{
    
    public:
        EFTInfo( const TreeReader& );

        // basic getters
        unsigned int numberOfEFTCoefficients() const{ return _numberOfEFTCoefficients; }

	// calculate weight for a given configuration of wilson coefficients
	double nominalWeight() const;
	double weight(const std::map<std::string, double>& wcValueMap) const;
	double relativeWeight(const std::map<std::string, double>& wcValueMap) const;

	// get correct indices for wilson coefficient combinations
	void checkWCName(const std::string& WCName) const;
	unsigned int getIndex(const std::string& WCName1, const std::string& WCName2) const;
	        
    private:
        static constexpr unsigned int maxNumberOfEFTCoefficients = 276;
	// (note: keep this number in sync with TreeReader and ntuplizer!)
        unsigned int _numberOfEFTCoefficients;
        double _EFTCoefficients[maxNumberOfEFTCoefficients];

	// define order of the wilson coefficients / operators
	// note: ideally this information should be in the samples,
	// but for now this is not the case so need to hard-code it here;
	// also check the getIndex functions in the source file.
	std::vector<std::string> _WCNames = {
	    "sm", "cpt", "ctp", "cptb", "cQlMi",
	    "cQq81", "cQq11", "cQl3i", "ctq8", "ctlTi",
	    "ctq1", "ctli", "cQq13", "cbW", "cpQM",
	    "cpQ3", "ctei", "cQei", "ctW", "ctlSi",
	    "cQq83", "ctZ", "ctG"
	};
	std::map<std::string, int> _WCIndexMap = {
	{"sm_sm", 0},
        {"sm_cpt", 1},
        {"sm_ctp", 3},
        {"sm_cptb", 6},
        {"sm_cQlMi", 10},
        {"sm_cQq81", 15},
        {"sm_cQq11", 21},
        {"sm_cQl3i", 28},
        {"sm_ctq8", 36},
        {"sm_ctlTi", 45},
        {"sm_ctq1", 55},
        {"sm_ctli", 66},
        {"sm_cQq13", 78},
        {"sm_cbW", 91},
        {"sm_cpQM", 105},
        {"sm_cpQ3", 120},
        {"sm_ctei", 136},
        {"sm_cQei", 153},
        {"sm_ctW", 171},
        {"sm_ctlSi", 190},
        {"sm_cQq83", 210},
        {"sm_ctZ", 231},
        {"sm_ctG", 253},
        {"cpt_cpt", 2},
        {"cpt_ctp", 4},
        {"cpt_cptb", 7},
        {"cpt_cQlMi", 11},
        {"cpt_cQq81", 16},
        {"cpt_cQq11", 22},
        {"cpt_cQl3i", 29},
        {"cpt_ctq8", 37},
        {"cpt_ctlTi", 46},
        {"cpt_ctq1", 56},
        {"cpt_ctli", 67},
        {"cpt_cQq13", 79},
        {"cpt_cbW", 92},
        {"cpt_cpQM", 106},
        {"cpt_cpQ3", 121},
        {"cpt_ctei", 137},
        {"cpt_cQei", 154},
        {"cpt_ctW", 172},
        {"cpt_ctlSi", 191},
        {"cpt_cQq83", 211},
        {"cpt_ctZ", 232},
        {"cpt_ctG", 254},
        {"ctp_ctp", 5},
        {"ctp_cptb", 8},
        {"ctp_cQlMi", 12},
        {"ctp_cQq81", 17},
        {"ctp_cQq11", 23},
        {"ctp_cQl3i", 30},
        {"ctp_ctq8", 38},
        {"ctp_ctlTi", 47},
        {"ctp_ctq1", 57},
        {"ctp_ctli", 68},
        {"ctp_cQq13", 80},
        {"ctp_cbW", 93},
        {"ctp_cpQM", 107},
        {"ctp_cpQ3", 122},
        {"ctp_ctei", 138},
        {"ctp_cQei", 155},
        {"ctp_ctW", 173},
        {"ctp_ctlSi", 192},
        {"ctp_cQq83", 212},
        {"ctp_ctZ", 233},
        {"ctp_ctG", 255},
        {"cptb_cptb", 9},
        {"cptb_cQlMi", 13},
        {"cptb_cQq81", 18},
        {"cptb_cQq11", 24},
        {"cptb_cQl3i", 31},
        {"cptb_ctq8", 39},
        {"cptb_ctlTi", 48},
        {"cptb_ctq1", 58},
        {"cptb_ctli", 69},
        {"cptb_cQq13", 81},
        {"cptb_cbW", 94},
        {"cptb_cpQM", 108},
        {"cptb_cpQ3", 123},
        {"cptb_ctei", 139},
        {"cptb_cQei", 156},
        {"cptb_ctW", 174},
        {"cptb_ctlSi", 193},
        {"cptb_cQq83", 213},
        {"cptb_ctZ", 234},
        {"cptb_ctG", 256},
        {"cQlMi_cQlMi", 14},
        {"cQlMi_cQq81", 19},
        {"cQlMi_cQq11", 25},
        {"cQlMi_cQl3i", 32},
        {"cQlMi_ctq8", 40},
        {"cQlMi_ctlTi", 49},
        {"cQlMi_ctq1", 59},
        {"cQlMi_ctli", 70},
        {"cQlMi_cQq13", 82},
        {"cQlMi_cbW", 95},
        {"cQlMi_cpQM", 109},
        {"cQlMi_cpQ3", 124},
        {"cQlMi_ctei", 140},
        {"cQlMi_cQei", 157},
        {"cQlMi_ctW", 175},
        {"cQlMi_ctlSi", 194},
        {"cQlMi_cQq83", 214},
        {"cQlMi_ctZ", 235},
        {"cQlMi_ctG", 257},
        {"cQq81_cQq81", 20},
        {"cQq81_cQq11", 26},
        {"cQq81_cQl3i", 33},
        {"cQq81_ctq8", 41},
        {"cQq81_ctlTi", 50},
        {"cQq81_ctq1", 60},
        {"cQq81_ctli", 71},
        {"cQq81_cQq13", 83},
        {"cQq81_cbW", 96},
        {"cQq81_cpQM", 110},
        {"cQq81_cpQ3", 125},
        {"cQq81_ctei", 141},
        {"cQq81_cQei", 158},
        {"cQq81_ctW", 176},
        {"cQq81_ctlSi", 195},
        {"cQq81_cQq83", 215},
        {"cQq81_ctZ", 236},
        {"cQq81_ctG", 258},
        {"cQq11_cQq11", 27},
        {"cQq11_cQl3i", 34},
        {"cQq11_ctq8", 42},
        {"cQq11_ctlTi", 51},
        {"cQq11_ctq1", 61},
        {"cQq11_ctli", 72},
        {"cQq11_cQq13", 84},
        {"cQq11_cbW", 97},
        {"cQq11_cpQM", 111},
        {"cQq11_cpQ3", 126},
        {"cQq11_ctei", 142},
        {"cQq11_cQei", 159},
        {"cQq11_ctW", 177},
        {"cQq11_ctlSi", 196},
        {"cQq11_cQq83", 216},
        {"cQq11_ctZ", 237},
        {"cQq11_ctG", 259},
        {"cQl3i_cQl3i", 35},
        {"cQl3i_ctq8", 43},
        {"cQl3i_ctlTi", 52},
        {"cQl3i_ctq1", 62},
        {"cQl3i_ctli", 73},
        {"cQl3i_cQq13", 85},
        {"cQl3i_cbW", 98},
        {"cQl3i_cpQM", 112},
        {"cQl3i_cpQ3", 127},
        {"cQl3i_ctei", 143},
        {"cQl3i_cQei", 160},
        {"cQl3i_ctW", 178},
        {"cQl3i_ctlSi", 197},
        {"cQl3i_cQq83", 217},
        {"cQl3i_ctZ", 238},
        {"cQl3i_ctG", 260},
        {"ctq8_ctq8", 44},
        {"ctq8_ctlTi", 53},
        {"ctq8_ctq1", 63},
        {"ctq8_ctli", 74},
        {"ctq8_cQq13", 86},
        {"ctq8_cbW", 99},
        {"ctq8_cpQM", 113},
        {"ctq8_cpQ3", 128},
        {"ctq8_ctei", 144},
        {"ctq8_cQei", 161},
        {"ctq8_ctW", 179},
        {"ctq8_ctlSi", 198},
        {"ctq8_cQq83", 218},
        {"ctq8_ctZ", 239},
        {"ctq8_ctG", 261},
        {"ctlTi_ctlTi", 54},
        {"ctlTi_ctq1", 64},
        {"ctlTi_ctli", 75},
        {"ctlTi_cQq13", 87},
        {"ctlTi_cbW", 100},
        {"ctlTi_cpQM", 114},
        {"ctlTi_cpQ3", 129},
        {"ctlTi_ctei", 145},
        {"ctlTi_cQei", 162},
        {"ctlTi_ctW", 180},
        {"ctlTi_ctlSi", 199},
        {"ctlTi_cQq83", 219},
        {"ctlTi_ctZ", 240},
        {"ctlTi_ctG", 262},
        {"ctq1_ctq1", 65},
        {"ctq1_ctli", 76},
        {"ctq1_cQq13", 88},
        {"ctq1_cbW", 101},
        {"ctq1_cpQM", 115},
        {"ctq1_cpQ3", 130},
        {"ctq1_ctei", 146},
        {"ctq1_cQei", 163},
        {"ctq1_ctW", 181},
        {"ctq1_ctlSi", 200},
        {"ctq1_cQq83", 220},
        {"ctq1_ctZ", 241},
        {"ctq1_ctG", 263},
        {"ctli_ctli", 77},
        {"ctli_cQq13", 89},
        {"ctli_cbW", 102},
        {"ctli_cpQM", 116},
        {"ctli_cpQ3", 131},
        {"ctli_ctei", 147},
        {"ctli_cQei", 164},
        {"ctli_ctW", 182},
        {"ctli_ctlSi", 201},
        {"ctli_cQq83", 221},
        {"ctli_ctZ", 242},
        {"ctli_ctG", 264},
        {"cQq13_cQq13", 90},
        {"cQq13_cbW", 103},
        {"cQq13_cpQM", 117},
        {"cQq13_cpQ3", 132},
        {"cQq13_ctei", 148},
        {"cQq13_cQei", 165},
        {"cQq13_ctW", 183},
        {"cQq13_ctlSi", 202},
        {"cQq13_cQq83", 222},
        {"cQq13_ctZ", 243},
        {"cQq13_ctG", 265},
        {"cbW_cbW", 104},
        {"cbW_cpQM", 118},
        {"cbW_cpQ3", 133},
        {"cbW_ctei", 149},
        {"cbW_cQei", 166},
        {"cbW_ctW", 184},
        {"cbW_ctlSi", 203},
        {"cbW_cQq83", 223},
        {"cbW_ctZ", 244},
        {"cbW_ctG", 266},
        {"cpQM_cpQM", 119},
        {"cpQM_cpQ3", 134},
        {"cpQM_ctei", 150},
        {"cpQM_cQei", 167},
        {"cpQM_ctW", 185},
        {"cpQM_ctlSi", 204},
        {"cpQM_cQq83", 224},
        {"cpQM_ctZ", 245},
        {"cpQM_ctG", 267},
        {"cpQ3_cpQ3", 135},
        {"cpQ3_ctei", 151},
        {"cpQ3_cQei", 168},
        {"cpQ3_ctW", 186},
        {"cpQ3_ctlSi", 205},
        {"cpQ3_cQq83", 225},
        {"cpQ3_ctZ", 246},
        {"cpQ3_ctG", 268},
        {"ctei_ctei", 152},
        {"ctei_cQei", 169},
        {"ctei_ctW", 187},
        {"ctei_ctlSi", 206},
        {"ctei_cQq83", 226},
        {"ctei_ctZ", 247},
        {"ctei_ctG", 269},
        {"cQei_cQei", 170},
        {"cQei_ctW", 188},
        {"cQei_ctlSi", 207},
        {"cQei_cQq83", 227},
        {"cQei_ctZ", 248},
        {"cQei_ctG", 270},
        {"ctW_ctW", 189},
        {"ctW_ctlSi", 208},
        {"ctW_cQq83", 228},
        {"ctW_ctZ", 249},
        {"ctW_ctG", 271},
        {"ctlSi_ctlSi", 209},
        {"ctlSi_cQq83", 229},
        {"ctlSi_ctZ", 250},
        {"ctlSi_ctG", 272},
        {"cQq83_cQq83", 230},
        {"cQq83_ctZ", 251},
        {"cQq83_ctG", 273},
        {"ctZ_ctZ", 252},
        {"ctZ_ctG", 274},
        {"ctG_ctG", 275}
	};
};

#endif 
